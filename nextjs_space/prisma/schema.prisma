generator client {
  provider      = "prisma-client-js"
  output        = "/home/ubuntu/organizen/nextjs_space/node_modules/.prisma/client"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model Company {
  id                     String                  @id @default(cuid())
  name                   String
  email                  String                  @unique
  phone                  String?
  website                String?
  address                String?
  city                   String?
  state                  String?
  country                String?
  postalCode             String?
  taxId                  String?
  defaultLanguage        String                  @default("pt")
  timezone               String                  @default("Europe/Lisbon")
  dateFormat             String                  @default("DD/MM/YYYY")
  timeFormat             String                  @default("24h")
  firstDayOfWeek         Int                     @default(1)
  currency               String                  @default("EUR")
  favicon                String?
  pwaIcon                String?
  businessHours          Json?
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  attendanceSettings     AttendanceSettings?
  branding               CompanyBranding?
  companyHolidays        CompanyHoliday[]
  customTaskPriorities   CustomTaskPriority[]
  customTaskStatuses     CustomTaskStatus[]
  customTaskTags         CustomTaskTag[]
  departmentCustomFields DepartmentCustomField[]
  departmentTemplates    DepartmentTemplate[]
  departments            Department[]
  messageTemplates       MessageTemplate[]
  messages               Message[]
  securitySettings       SecuritySettings?
  shiftReminders         ShiftReminder[]
  shiftTemplates         ShiftTemplate[]
  shifts                 Shift[]
  tasks                  Task[]
  users                  User[]

  @@map("companies")
}

model CompanyBranding {
  id                   String   @id @default(cuid())
  companyId            String   @unique
  logoUrl              String?
  logoSize             Int?     @default(150)
  primaryColor         String   @default("#3B82F6")
  secondaryColor       String?
  accentColor          String?
  loginBackgroundType  String   @default("gradient")
  loginBackgroundImage String?
  loginBackgroundColor String?
  welcomeMessage       String?
  tagline              String?
  supportLink          String?
  termsLink            String?
  privacyLink          String?
  theme                String   @default("light")
  customSubdomain      String?  @unique
  customDomain         String?  @unique
  emailHeaderColor     String?
  emailSignature       String?
  emailSenderName      String?
  emailFooter          String?
  emailWelcomeSubject  String?  @default("Bem-vindo(a) ao {{companyName}}!")
  emailWelcomeBody     String?
  emailWelcomeEnabled  Boolean  @default(true)
  emailResetSubject    String?  @default("Redefinir sua senha")
  emailResetBody       String?
  emailResetEnabled    Boolean  @default(true)
  emailInviteSubject   String?  @default("Você foi convidado(a) para {{companyName}}")
  emailInviteBody      String?
  emailInviteEnabled   Boolean  @default(true)
  emailNotifySubject   String?  @default("Notificação de {{companyName}}")
  emailNotifyBody      String?
  emailNotifyEnabled   Boolean  @default(true)
  isActive             Boolean  @default(true)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  company              Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("company_branding")
}

model Department {
  id               String              @id @default(cuid())
  name             String
  companyId        String
  templateId       String?
  customFieldsData Json?
  displayOrder     Int                 @default(0)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt
  company          Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  template         DepartmentTemplate? @relation(fields: [templateId], references: [id])
  teams            Team[]
  userDepartments  UserDepartment[]    @relation("UserDepartments")
  users            User[]

  @@map("departments")
}

model DepartmentTemplate {
  id                 String                @id @default(cuid())
  companyId          String
  name               String
  description        String?
  defaultManagerRole String?
  createdAt          DateTime              @default(now())
  updatedAt          DateTime              @updatedAt
  company            Company               @relation(fields: [companyId], references: [id], onDelete: Cascade)
  departments        Department[]
  customFields       TemplateCustomField[]

  @@unique([companyId, name])
  @@map("department_templates")
}

model TemplateCustomField {
  id           String             @id @default(cuid())
  templateId   String
  name         String
  fieldType    String
  options      String?
  isRequired   Boolean            @default(false)
  displayOrder Int                @default(0)
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  template     DepartmentTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@map("template_custom_fields")
}

model DepartmentCustomField {
  id           String   @id @default(cuid())
  companyId    String
  fieldName    String
  fieldType    String
  fieldOptions Json?
  isRequired   Boolean  @default(false)
  order        Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  company      Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, fieldName])
  @@map("department_custom_fields")
}

model Team {
  id           String     @id @default(cuid())
  name         String
  description  String?
  departmentId String
  leaderId     String?
  parentTeamId String?
  level        TeamLevel  @default(OPERATIONS)
  displayOrder Int        @default(0)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  department   Department @relation(fields: [departmentId], references: [id], onDelete: Cascade)
  leader       User?      @relation("TeamLeader", fields: [leaderId], references: [id])
  parentTeam   Team?      @relation("TeamHierarchy", fields: [parentTeamId], references: [id])
  childTeams   Team[]     @relation("TeamHierarchy")
  members      User[]     @relation("TeamMembers")

  @@index([leaderId])
  @@index([parentTeamId])
  @@index([departmentId])
  @@map("teams")
}

model User {
  id                       String              @id @default(cuid())
  name                     String?
  email                    String              @unique
  emailVerified            DateTime?
  image                    String?
  password                 String?
  role                     UserRole            @default(STAFF)
  companyId                String
  departmentId             String?
  teamId                   String?
  language                 String              @default("pt")
  waitingListOrder         Int                 @default(0)
  teamMemberOrder          Int                 @default(0)
  approved                 Boolean             @default(false)
  approvedAt               DateTime?
  approvedBy               String?
  phone                    String?
  address                  String?
  city                     String?
  state                    String?
  country                  String?
  postalCode               String?
  birthDate                DateTime?
  taxId                    String?
  employeeNumber           String?
  hireDate                 DateTime?
  jobTitle                 String?
  emergencyContactName     String?
  emergencyContactPhone    String?
  emergencyContactRelation String?
  createdAt                DateTime            @default(now())
  updatedAt                DateTime            @updatedAt
  emailSignature           String?
  accounts                 Account[]
  sessions                 Session[]
  eventCollaborators       EventCollaborator[]
  messageRecipients        MessageRecipient[]
  messageTemplates         MessageTemplate[]
  receivedMessages         Message[]           @relation("ReceivedMessages")
  sentMessages             Message[]           @relation("SentMessages")
  shiftAssignments         ShiftAssignment[]
  shiftSwapRequests        ShiftSwapRequest[]  @relation("ShiftSwapRequester")
  shiftSwapRequestsTarget  ShiftSwapRequest[]  @relation("ShiftSwapTarget")
  assignedShifts           Shift[]
  taskComments             TaskComment[]
  taskMembers              TaskMember[]
  assignedTasks            Task[]
  ledTeams                 Team[]              @relation("TeamLeader")
  testimonials             Testimonial[]
  timeOffRequests          TimeOffRequest[]
  userDepartments          UserDepartment[]
  company                  Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  department               Department?         @relation(fields: [departmentId], references: [id])
  team                     Team?               @relation("TeamMembers", fields: [teamId], references: [id])

  @@map("users")
}

model Shift {
  id           String            @id @default(cuid())
  title        String
  description  String?
  startTime    DateTime
  endTime      DateTime
  userId       String            @map("user_id")
  companyId    String            @map("company_id")
  capacity     Int               @default(1)
  displayOrder Int               @default(0)
  createdAt    DateTime          @default(now()) @map("created_at")
  updatedAt    DateTime          @updatedAt @map("updated_at")
  assignments  ShiftAssignment[]
  company      Company           @relation(fields: [companyId], references: [id], onDelete: Cascade)
  user         User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("shifts")
}

model ShiftAssignment {
  id         String                @id @default(cuid())
  shiftId    String                @map("shift_id")
  userId     String                @map("user_id")
  status     ShiftAssignmentStatus @default(CONFIRMED)
  notes      String?
  createdAt  DateTime              @default(now()) @map("created_at")
  updatedAt  DateTime              @updatedAt @map("updated_at")
  attendance Attendance?
  shift      Shift                 @relation(fields: [shiftId], references: [id], onDelete: Cascade)
  user       User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([shiftId, userId])
  @@map("shift_assignments")
}

model ShiftReminder {
  id            String   @id @default(cuid())
  shiftId       String
  reminderHours Int
  sentAt        DateTime @default(now())
  companyId     String
  company       Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([shiftId, reminderHours])
  @@map("shift_reminders")
}

model Task {
  id               String              @id @default(cuid())
  title            String
  description      String?
  dueDate          DateTime?
  status           TaskStatus          @default(PENDING)
  priority         TaskPriority?       @default(MEDIUM)
  customStatusId   String?
  customPriorityId String?
  userId           String
  companyId        String
  parentId         String?
  displayOrder     Int                 @default(0)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt
  completedAt      DateTime?
  startedAt        DateTime?
  eventId          String?
  checkItems       CheckItem[]
  attachments      TaskAttachment[]
  comments         TaskComment[]
  customTags       TaskCustomTag[]
  members          TaskMember[]
  tags             TaskTag[]
  company          Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customPriority   CustomTaskPriority? @relation(fields: [customPriorityId], references: [id])
  customStatus     CustomTaskStatus?   @relation(fields: [customStatusId], references: [id])
  event            Event?              @relation(fields: [eventId], references: [id], onDelete: Cascade)
  parent           Task?               @relation("TaskSubtasks", fields: [parentId], references: [id], onDelete: Cascade)
  subtasks         Task[]              @relation("TaskSubtasks")
  user             User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("tasks")
}

model TaskMember {
  id        String   @id @default(cuid())
  taskId    String
  userId    String
  role      String   @default("MEMBER")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  task      Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([taskId, userId])
  @@map("task_members")
}

model TaskComment {
  id        String   @id @default(cuid())
  content   String
  taskId    String
  userId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  task      Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("task_comments")
}

model CheckItem {
  id        String   @id @default(cuid())
  title     String
  completed Boolean  @default(false)
  order     Int      @default(0)
  taskId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  task      Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@map("check_items")
}

model TaskTag {
  id        String   @id @default(cuid())
  name      String
  color     String   @default("#3B82F6")
  taskId    String
  createdAt DateTime @default(now())
  task      Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@map("task_tags")
}

model TaskAttachment {
  id                 String   @id @default(cuid())
  fileName           String
  fileSize           Int
  mimeType           String
  cloud_storage_path String
  taskId             String
  createdAt          DateTime @default(now())
  task               Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@map("task_attachments")
}

model Message {
  id           String             @id @default(cuid())
  subject      String
  content      String
  read         Boolean            @default(false)
  archived     Boolean            @default(false)
  deleted      Boolean            @default(false)
  folderId     String?
  senderId     String
  receiverId   String
  companyId    String
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  isDraft      Boolean            @default(false)
  priority     MessagePriority    @default(NORMAL)
  replyToId    String?
  scheduledFor DateTime?
  attachments  Attachment[]
  recipients   MessageRecipient[]
  company      Company            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  folder       MessageFolder?     @relation(fields: [folderId], references: [id])
  receiver     User               @relation("ReceivedMessages", fields: [receiverId], references: [id], onDelete: Cascade)
  replyTo      Message?           @relation("MessageReplies", fields: [replyToId], references: [id])
  replies      Message[]          @relation("MessageReplies")
  sender       User               @relation("SentMessages", fields: [senderId], references: [id], onDelete: Cascade)

  @@map("messages")
}

model MessageRecipient {
  id        String        @id @default(cuid())
  messageId String
  userId    String
  type      RecipientType @default(TO)
  read      Boolean       @default(false)
  readAt    DateTime?
  createdAt DateTime      @default(now())
  message   Message       @relation(fields: [messageId], references: [id], onDelete: Cascade)
  user      User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([messageId, userId, type])
  @@map("message_recipients")
}

model MessageTemplate {
  id        String   @id @default(cuid())
  name      String
  subject   String
  content   String
  isPublic  Boolean  @default(false)
  category  String?
  userId    String?
  companyId String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  user      User?    @relation(fields: [userId], references: [id])

  @@map("message_templates")
}

model Attachment {
  id                 String   @id @default(cuid())
  fileName           String
  fileSize           Int
  mimeType           String
  cloud_storage_path String
  messageId          String?
  chatMessageId      String?
  createdAt          DateTime @default(now())
  message            Message? @relation(fields: [messageId], references: [id], onDelete: Cascade)

  @@index([chatMessageId])
  @@map("attachments")
}

model MessageFolder {
  id           String    @id @default(cuid())
  name         String
  color        String?
  userId       String
  displayOrder Int       @default(0)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  messages     Message[]

  @@map("message_folders")
}

model Notification {
  id        String           @id @default(cuid())
  title     String
  message   String
  type      NotificationType
  read      Boolean          @default(false)
  userId    String
  relatedId String?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  @@map("notifications")
}

model PushSubscription {
  id        String   @id @default(cuid())
  userId    String
  endpoint  String   @unique
  p256dh    String
  auth      String
  userAgent String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@map("push_subscriptions")
}

model ChatMessage {
  id             String   @id @default(cuid())
  content        String
  read           Boolean  @default(false)
  senderId       String
  receiverId     String?
  groupId        String?
  companyId      String
  attachmentUrl  String?
  attachmentType String?
  attachmentName String?
  attachmentSize Int?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([senderId, receiverId])
  @@index([companyId])
  @@index([groupId])
  @@map("chat_messages")
}

model ChatGroup {
  id          String   @id @default(cuid())
  name        String
  description String?
  type        String?
  companyId   String
  createdBy   String?
  createdById String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([companyId])
  @@map("chat_groups")
}

model ChatGroupMember {
  id        String   @id @default(cuid())
  groupId   String
  userId    String
  role      String?
  joinedAt  DateTime @default(now())
  isMuted   Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([groupId, userId])
  @@index([groupId])
  @@index([userId])
  @@map("chat_group_members")
}

model BirthdaySettings {
  id                   String   @id @default(cuid())
  companyId            String   @unique
  enabled              Boolean  @default(true)
  messageTemplate      String?
  sendTime             String   @default("09:00")
  notifyBirthdayPerson Boolean  @default(true)
  notifyManagers       Boolean  @default(true)
  notifyTeamMembers    Boolean  @default(true)
  visibility           String   @default("PUBLIC")
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@map("birthday_settings")
}

model UserDepartment {
  id           String     @id @default(cuid())
  userId       String
  departmentId String
  isPrimary    Boolean    @default(false)
  isActive     Boolean    @default(true)
  priority     Int        @default(0)
  role         String?
  availability String?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  department   Department @relation("UserDepartments", fields: [departmentId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, departmentId])
  @@index([userId])
  @@index([departmentId])
  @@map("user_departments")
}

model UserStatus {
  id           String   @id @default(cuid())
  userId       String   @unique
  isOnline     Boolean  @default(false)
  lastSeen     DateTime @default(now())
  isTyping     Boolean  @default(false)
  typingTo     String?
  lastActivity DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([userId])
  @@map("user_status")
}

model ShiftSwapRequest {
  id              String        @id @default(cuid())
  requesterId     String
  targetUserId    String?
  originalShiftId String
  offeredShiftId  String?
  reason          String?
  status          RequestStatus @default(PENDING)
  responseMessage String?
  reviewedBy      String?
  reviewedAt      DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  requester       User          @relation("ShiftSwapRequester", fields: [requesterId], references: [id], onDelete: Cascade)
  targetUser      User?         @relation("ShiftSwapTarget", fields: [targetUserId], references: [id], onDelete: Cascade)

  @@index([requesterId])
  @@index([targetUserId])
  @@index([status])
  @@map("shift_swap_requests")
}

model TimeOffRequest {
  id              String        @id @default(cuid())
  userId          String
  type            TimeOffType   @default(VACATION)
  startDate       DateTime
  endDate         DateTime
  reason          String?
  status          RequestStatus @default(PENDING)
  responseMessage String?
  reviewedBy      String?
  reviewedAt      DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@map("time_off_requests")
}

model PasswordResetToken {
  id        String   @id @default(cuid())
  email     String
  token     String   @unique
  expires   DateTime
  used      Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([email])
  @@index([token])
}

model ActiveSession {
  id           String   @id @default(cuid())
  userId       String
  sessionToken String   @unique
  ipAddress    String?
  userAgent    String?
  device       String?
  location     String?
  lastActivity DateTime @default(now())
  expiresAt    DateTime
  createdAt    DateTime @default(now())

  @@index([userId])
  @@index([sessionToken])
  @@index([expiresAt])
  @@map("active_sessions")
}

model SecuritySettings {
  id                     String   @id @default(cuid())
  companyId              String   @unique
  minPasswordLength      Int      @default(8)
  requireUppercase       Boolean  @default(true)
  requireLowercase       Boolean  @default(true)
  requireNumbers         Boolean  @default(true)
  requireSpecialChars    Boolean  @default(false)
  passwordExpirationDays Int?
  sessionTimeoutMinutes  Int      @default(480)
  maxConcurrentSessions  Int      @default(3)
  requireApproval        Boolean  @default(false)
  autoApproveEmails      String[]
  defaultRole            String   @default("STAFF")
  defaultPermissions     Json?
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  company                Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("security_settings")
}

model CustomTaskStatus {
  id         String   @id @default(cuid())
  companyId  String
  name       String
  color      String   @default("#3B82F6")
  icon       String?
  order      Int      @default(0)
  isDefault  Boolean  @default(false)
  isArchived Boolean  @default(false)
  createdAt  DateTime @default(now())
  company    Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  tasks      Task[]

  @@unique([companyId, name])
  @@map("custom_task_statuses")
}

model CustomTaskTag {
  id          String          @id @default(cuid())
  companyId   String
  name        String
  color       String          @default("#3B82F6")
  description String?
  order       Int             @default(0)
  createdAt   DateTime        @default(now())
  company     Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  tasks       TaskCustomTag[]

  @@unique([companyId, name])
  @@map("custom_task_tags")
}

model TaskCustomTag {
  id        String        @id @default(cuid())
  taskId    String
  tagId     String
  createdAt DateTime      @default(now())
  tag       CustomTaskTag @relation(fields: [tagId], references: [id], onDelete: Cascade)
  task      Task          @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@unique([taskId, tagId])
  @@map("task_custom_tags")
}

model CustomTaskPriority {
  id        String   @id @default(cuid())
  companyId String
  name      String
  level     Int
  color     String   @default("#3B82F6")
  icon      String?
  isDefault Boolean  @default(false)
  createdAt DateTime @default(now())
  company   Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  tasks     Task[]

  @@unique([companyId, name])
  @@unique([companyId, level])
  @@map("custom_task_priorities")
}

model NotificationSettings {
  id                   String   @id @default(cuid())
  userId               String   @unique
  emailOnTaskAssigned  Boolean  @default(true)
  emailOnTaskCompleted Boolean  @default(true)
  emailOnTaskComment   Boolean  @default(true)
  emailOnMention       Boolean  @default(true)
  emailOnDeadline      Boolean  @default(true)
  emailOnShiftAssigned Boolean  @default(true)
  emailOnShiftSwap     Boolean  @default(true)
  emailOnTimeOff       Boolean  @default(true)
  emailOnMessage       Boolean  @default(true)
  pushEnabled          Boolean  @default(true)
  pushOnTaskAssigned   Boolean  @default(true)
  pushOnTaskComment    Boolean  @default(true)
  pushOnMention        Boolean  @default(true)
  pushOnMessage        Boolean  @default(true)
  pushOnShiftSwap      Boolean  @default(true)
  pushOnTimeOff        Boolean  @default(true)
  dailyDigest          Boolean  @default(false)
  weeklyDigest         Boolean  @default(true)
  monthlyDigest        Boolean  @default(false)
  digestTime           String   @default("09:00")
  digestDayOfWeek      Int?     @default(1)
  digestDayOfMonth     Int?     @default(1)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@map("notification_settings")
}

model Testimonial {
  id        String   @id @default(cuid())
  companyId String
  userId    String?
  name      String
  jobTitle  String
  company   String
  comment   String
  rating    Int      @default(5)
  isActive  Boolean  @default(true)
  order     Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User?    @relation(fields: [userId], references: [id])

  @@map("testimonials")
}

model ShiftTemplate {
  id            String   @id @default(cuid())
  companyId     String
  name          String
  startTime     String
  endTime       String
  breakDuration Int?
  color         String   @default("#3B82F6")
  description   String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  company       Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@map("shift_templates")
}

model CompanyHoliday {
  id          String   @id @default(cuid())
  companyId   String
  name        String
  date        DateTime
  isRecurring Boolean  @default(false)
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("company_holidays")
}

model Event {
  id              String              @id @default(cuid())
  name            String
  description     String?
  eventType       EventType           @default(OTHER)
  location        String?
  eventDate       DateTime
  endDate         DateTime?
  status          EventStatus         @default(PLANNING)
  companyId       String
  createdBy       String
  budget          Float?
  estimatedGuests Int?
  notes           String?
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  chatMessages    EventChatMessage[]
  collaborators   EventCollaborator[]
  images          EventImage[]
  tasks           Task[]

  @@index([companyId])
  @@index([eventDate])
  @@index([status])
  @@map("events")
}

model EventCollaborator {
  id           String                @id @default(cuid())
  eventId      String
  userId       String
  role         EventCollaboratorRole @default(MEMBER)
  departmentId String?
  canManage    Boolean               @default(false)
  canChat      Boolean               @default(true)
  joinedAt     DateTime              @default(now())
  createdAt    DateTime              @default(now())
  updatedAt    DateTime              @updatedAt
  event        Event                 @relation(fields: [eventId], references: [id], onDelete: Cascade)
  user         User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([eventId, userId])
  @@index([eventId])
  @@index([userId])
  @@map("event_collaborators")
}

model EventImage {
  id                 String   @id @default(cuid())
  eventId            String
  fileName           String
  fileSize           Int
  mimeType           String
  cloud_storage_path String
  uploadedBy         String
  description        String?
  createdAt          DateTime @default(now())
  event              Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@index([eventId])
  @@map("event_images")
}

model EventChatMessage {
  id             String   @id @default(cuid())
  eventId        String
  senderId       String
  content        String
  read           Boolean  @default(false)
  attachmentUrl  String?
  attachmentType String?
  attachmentName String?
  attachmentSize Int?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  event          Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@index([eventId])
  @@index([senderId])
  @@map("event_chat_messages")
}

model AttendanceSettings {
  id                    String   @id @default(cuid())
  companyId             String   @unique
  allowManagerClockIn   Boolean  @default(true)
  allowSelfClockIn      Boolean  @default(false)
  requireGPS            Boolean  @default(false)
  maxGPSRadiusMeters    Int      @default(100)
  companyLatitude       Float?
  companyLongitude      Float?
  lateToleranceMinutes  Int      @default(15)
  earlyDepartureMinutes Int      @default(15)
  notifyOnLate          Boolean  @default(true)
  notifyOnAbsent        Boolean  @default(true)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  company               Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("attendance_settings")
}

model Attendance {
  id                String           @id @default(cuid())
  shiftAssignmentId String           @unique
  clockInTime       DateTime?
  clockOutTime      DateTime?
  clockInLatitude   Float?
  clockInLongitude  Float?
  clockOutLatitude  Float?
  clockOutLongitude Float?
  status            AttendanceStatus @default(PENDING)
  notes             String?
  justification     String?
  justifiedBy       String?
  minutesLate       Int?
  minutesEarly      Int?
  totalMinutes      Int?
  clockedInBy       String?
  clockedOutBy      String?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  shiftAssignment   ShiftAssignment  @relation(fields: [shiftAssignmentId], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([clockInTime])
  @@map("attendances")
}

enum ShiftAssignmentStatus {
  CONFIRMED
  PENDING
  CANCELLED
}

enum MessagePriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

enum RecipientType {
  TO
  CC
  BCC
}

enum UserRole {
  ADMIN
  MANAGER
  SUPERVISOR
  STAFF
}

enum TeamLevel {
  COMPANY
  MANAGEMENT
  SUPERVISION
  OPERATIONS
}

enum TaskStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
}

enum TaskPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum NotificationType {
  MESSAGE
  TASK
  TASK_ASSIGNED
  TASK_COMMENT
  SHIFT
  SHIFT_REMINDER
  SYSTEM
  CHAT
  SHIFT_SWAP
  TIME_OFF
  MENTION
  REPORT
  BIRTHDAY
}

enum RequestStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
}

enum TimeOffType {
  VACATION
  SICK_LEAVE
  PERSONAL
  OTHER
}

enum AttendanceStatus {
  PENDING
  PRESENT
  LATE
  ABSENT_JUSTIFIED
  ABSENT_UNJUSTIFIED
  HALF_DAY
  EARLY_DEPARTURE
}

enum EventType {
  WEDDING
  BIRTHDAY
  CONFERENCE
  CORPORATE
  THEMED_PARTY
  CONGRESS
  OTHER
}

enum EventStatus {
  PLANNING
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum EventCollaboratorRole {
  COORDINATOR
  MANAGER
  MEMBER
  EXTERNAL
}
